Harika bir fikir. Bu "Change Log" (DeÄŸiÅŸiklik KaydÄ±) yaklaÅŸÄ±mÄ±, projenin evrildiÄŸini ve yaÅŸayan bir sÃ¼reÃ§ olduÄŸunu gÃ¶sterir. Hem takÄ±m arkadaÅŸlarÄ±nÄ±n senkronize olmasÄ±nÄ± saÄŸlar hem de hocana "Biz sadece kaÄŸÄ±t Ã¼zerinde kalmadÄ±k, geliÅŸtirirken mimariyi iyileÅŸtirdik" mesajÄ±nÄ± verir.

Senin iÃ§in **"Project Revision & Architectural Changes"** (Proje Revizyonu ve Mimari DeÄŸiÅŸiklikler) baÅŸlÄ±ÄŸÄ± altÄ±nda, yaptÄ±ÄŸÄ±mÄ±z tÃ¼m kritik deÄŸiÅŸiklikleri Ã¶zetleyen, arkadaÅŸlarÄ±nla paylaÅŸabileceÄŸin formatta bir metin hazÄ±rladÄ±m. Bunu bir PDF veya Word dosyasÄ±na yapÄ±ÅŸtÄ±rÄ±p paylaÅŸabilirsin.

Ä°ÅŸte iÃ§erik:

***

# ğŸ“„ Project Revision Report: Architectural Changes & Decisions
**Date:** November 24, 2025
**Status:** Milestone 1 & 2 Alignment

Bu belge, "Phase 1: Project Proposal" raporundan sonra, geliÅŸtirme aÅŸamasÄ±nda (Milestone 1) alÄ±nan teknik ve mimari deÄŸiÅŸiklik kararlarÄ±nÄ± Ã¶zetlemektedir. TÃ¼m ekip Ã¼yelerinin (Backend, Frontend, DB) bu yeni yapÄ±ya gÃ¶re ilerlemesi gerekmektedir.

---

### 1. E/R Diagram & Database Schema Updates (En Kritik DeÄŸiÅŸiklik)

**Eski Durum:**
* `UserPurchasedBook` tablosu vardÄ± ve sadece **Dijital E-Kitap** satÄ±ÅŸÄ±nÄ± takip ediyordu.
* `Book` tablosunda sadece kiralama stoÄŸu ve tek bir fiyat vardÄ±.

**Yeni Durum (Refactored Architecture):**
Proje kapsamÄ± **"Fiziksel Kitap SatÄ±ÅŸÄ±"nÄ±** da kapsayacak ÅŸekilde geniÅŸletildi. KÃ¼tÃ¼phane, elindeki fazla stoklarÄ± (tÄ±pkÄ± e-kitap gibi) kullanÄ±cÄ±lara satabilecek.

* **`UserPurchasedBook` Tablosu Ä°PTAL EDÄ°LDÄ° (Deleted):**
    * Yerine **`BookSale`** tablosu eklendi.
    * Bu tablo `sale_type` (ENUM: `PHYSICAL_COPY`, `DIGITAL_COPY`) sÃ¼tunu ile hem dijital hem fiziksel satÄ±ÅŸlarÄ± tek merkezden yÃ¶netecek.
* **`Book` Entity GÃ¼ncellemesi:**
    * Stok yÃ¶netimi ayrÄ±ldÄ±:
        * `totalRentalStock` / `availableRentalStock`: Sadece kiralama iÃ§in.
        * `totalSaleStock` (YENÄ°): Sadece fiziksel satÄ±ÅŸ iÃ§in ayrÄ±lan stok.
    * FiyatlandÄ±rma ayrÄ±ldÄ±:
        * `physicalPrice`: Fiziksel kopya satÄ±ÅŸ fiyatÄ±.
        * `digitalPrice`: E-kitap indirme fiyatÄ±.

---

### 2. Entity & Code Structure Decisions

**Eski Durum:**
Her Entity (User, Wallet, Book) kendi iÃ§inde `createdAt` tarihi oluÅŸturuyor veya hiÃ§ tutmuyordu. Kod tekrarÄ± vardÄ±.

**Yeni Durum (Clean Code & Audit):**
* **`BaseEntity` Mimarisi:**
    * `BaseEntity` adÄ±nda soyut (abstract) bir sÄ±nÄ±f oluÅŸturuldu.
    * `created_at` ve `updated_at` alanlarÄ± buraya taÅŸÄ±ndÄ±.
    * `@PrePersist` ve `@PreUpdate` ile tarih atama iÅŸlemleri otomatikleÅŸtirildi.
    * TÃ¼m ana Entity'ler (`User`, `Book`, `Rental`, `BookSale`, `Rating`) artÄ±k `extends BaseEntity` yaparak bu Ã¶zelliÄŸi miras alÄ±yor.

---

### 3. Scope Management (Kapsam YÃ¶netimi)

Raporun "Prognosis" kÄ±smÄ±ndaki riskleri yÃ¶netmek iÃ§in ÅŸu kararlar kesinleÅŸti:

* **Rezervasyon Sistemi:**
    * **Karar:** KarmaÅŸÄ±k "SÄ±ra/Kuyruk" (Queue) sistemi **YAPILMAYACAK**.
    * **Alternatif:** `Book` tablosuna sadece `reserved_by_user_id` alanÄ± eklendi. Åimdilik sadece veritabanÄ± altyapÄ±sÄ± hazÄ±r tutulacak (Opsiyonel), iÅŸ mantÄ±ÄŸÄ± (Backend kodu) Ã¶ncelikli deÄŸil.
* **Ä°kinci El Pazar Yeri (P2P):**
    * **Karar:** Ä°PTAL EDÄ°LDÄ°. Proje odaÄŸÄ± daÄŸÄ±tmamak iÃ§in kullanÄ±cÄ±dan kullanÄ±cÄ±ya satÄ±ÅŸ yok. Sadece KÃ¼tÃ¼phane -> KullanÄ±cÄ± satÄ±ÅŸÄ± var.

---

### 4. Action Plan for the Team (TakÄ±m Ä°Ã§in Aksiyonlar)

1.  **Backend:** `Book.java` entity'si yukarÄ±daki yeni stok/fiyat yapÄ±sÄ±na gÃ¶re gÃ¼ncellenecek. `UserPurchasedBook` silinip `BookSale` oluÅŸturulacak.
2.  **Database:** `docker compose up -d` yapÄ±ldÄ±ÄŸÄ±nda tablolarÄ±n bu yeni yapÄ±ya gÃ¶re (Hibernate `ddl-auto=update` sayesinde) gÃ¼ncellendiÄŸi teyit edilecek.
3.  **Frontend:** Kitap detay sayfasÄ±nda artÄ±k iki buton olacak:
    * "Kirala" (Stok varsa)
    * "SatÄ±n Al" (Fiziksel veya Dijital seÃ§enekli)

***

Bu metni arkadaÅŸlarÄ±na iletebilirsin. Onaylarsan kodlamaya kaldÄ±ÄŸÄ±mÄ±z yerden (`Rating.java`) devam edelim.